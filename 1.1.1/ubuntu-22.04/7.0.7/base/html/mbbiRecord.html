<html><head><title>Multi-Bit Binary Input Record (mbbi)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
<link rel="stylesheet" type="text/css" title="pod_stylesheet" href="style.css">

</head>
<body class='pod'>
<!--
  generated by EPICS::PodHtml v,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Thu May 15 05:22:21 2025 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to EPICS::PodHtml, and/or subclassing EPICS::PodHtml,
   then reconverting this document from the Pod source.
   When in doubt, email the author of EPICS::PodHtml for advice.
   See 'perldoc EPICS::PodHtml' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>
<div class="pod">


<h1><a class='u'
name="Multi-Bit-Binary-Input-Record-mbbi"
>Multi-Bit Binary Input Record (mbbi)</a></h1>

<p>The normal use for the multi-bit binary input record is to read contiguous,
multiple bit inputs from hardware.
The binary value represents a state from a range of up to 16 states.
The multi-bit input record interfaces with devices that use more than one bit.</p>

<p>Most device support modules obtain values from hardware and place the value in RVAL.
For these device support modules record processing uses RVAL to determine the current state (VAL is given a value between 0 and 15).
Device support modules may optionally read a value directly into VAL.</p>

<p>Soft device modules are provided to obtain input via database or channel access links or via dbPutField or dbPutLink requests.
Two soft device support modules are provided: <code>Soft Channel</code> allows VAL to be an arbitrary unsigned short integer.
<code>Raw Soft Channel</code> reads the value into RVAL just like normal device support modules.</p>

<h2><a class='u'
name="Parameter-Fields"
>Parameter Fields</a></h2>

<p>The record-specific fields are described below,
grouped by functionality.</p>

<h3><a class='u'
name="Scan-Parameters"
>Scan Parameters</a></h3>

<p>The multi-bit binary input record has the standard fields for specifying under what circumstances it will be processed.
These fields are listed in <a href="dbCommonRecord.html#Scan-Fields" class="podlinkpod"
>Scan Fields</a>.</p>

<h3><a class='u'
name="Read-and-Convert-Parameters"
>Read and Convert Parameters</a></h3>

<p>The device support routines obtain the record&#39;s input from the device or link specified in the INP field.
For records that obtain their input from devices,
the INP field must contain the address of the I/O card,
and the DTYP field must specify the proper device support module.
Be aware that the address format differs according to the I/O bus used.</p>

<p>Two soft device support modules can be specified in DTYP <code>Soft Channel</code> and <code>Raw Soft Channel</code>.</p>

<p><code>Raw Soft Channel</code> reads the value into RVAL,
upon which the normal conversion process is undergone.
<code>Soft Channel</code> reads any unsigned integer directly into VAL.
For a soft mbbi record,
the INP field can be a constant,
a database,
or a channel access link.
If INP is a constant,
then the VAL is initialized to the constant value but can be changed at run-time via dbPutField or dbPutLink.</p>

<p>MASK is used by the raw soft channel read routine,
and by typical device support read routines,
to select only the desired bits when reading the hardware register.
It is initialized to ((1 &#60;&#60; NOBT) - 1) by record initialization.
The user can configure the NOBT field,
but the device support routines may set it,
in which case the value given to it by the user is simply overridden.
The device support routines may also override MASK or shift it left by SHFT bits.
If MASK is non-zero,
only the bits specified by MASK will appear in RVAL.</p>

<p>Unless the device support routine specifies no conversion,
RVAL is used to determine VAL as follows:</p>

<ol>
<li>RVAL is assigned to a temporary variable -- rval = RVAL</li>

<li>rval is shifted right SHFT number of bits.</li>

<li>A match is sought between rval and one of the state value fields,
ZRVL-FFVL.</li>
</ol>

<p>Each of the fields,
ZRVL-FFVL,
represents one of the possible sixteen states (not all sixteen have to be used).</p>

<p>Alternatively,
the input value can be read as a string,
in which case,
a match is sought with one of the strings specified in the ZRST-FFST fields.
Then RVAL is set equal to the corresponding value for that string,
and the conversion process occurs.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">VAL</td><td class="cell">Current Value</td><td class="cell">ENUM</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">INP</td><td class="cell">Input Specification</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">MASK</td><td class="cell">Hardware Mask</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NOBT</td><td class="cell">Number of Bits</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">RVAL</td><td class="cell">Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SHFT</td><td class="cell">Shift</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">ZRVL</td><td class="cell">Zero Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ONVL</td><td class="cell">One Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TWVL</td><td class="cell">Two Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">THVL</td><td class="cell">Three Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FRVL</td><td class="cell">Four Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FVVL</td><td class="cell">Five Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SXVL</td><td class="cell">Six Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SVVL</td><td class="cell">Seven Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">EIVL</td><td class="cell">Eight Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NIVL</td><td class="cell">Nine Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TEVL</td><td class="cell">Ten Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ELVL</td><td class="cell">Eleven Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TVVL</td><td class="cell">Twelve Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TTVL</td><td class="cell">Thirteen Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FTVL</td><td class="cell">Fourteen Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FFVL</td><td class="cell">Fifteen Value</td><td class="cell">ULONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h3><a class='u'
name="Operator-Display-Parameters"
>Operator Display Parameters</a></h3>

<p>These parameters are used to present meaningful data to the operator.
They display the value and other parameters of the mbbi record either textually or graphically.
The ZRST-FFST fields contain strings describing one of the possible states of the record.
The <code>get_enum_str</code> and <code>get_enum_strs</code> record routines retrieve these strings for the operator.
<code>Get_enum_str</code> gets the string corresponding to the value set in VAL,
and <code>get_enum_strs</code> retrieves all the strings.</p>

<p>See <a href="dbCommonRecord.html#Operator-Display-Parameters" class="podlinkpod"
>Fields Common to All Record Types</a> for more on the record name (NAME) and description (DESC) fields.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">NAME</td><td class="cell">Record Name</td><td class="cell">STRING [61]</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">DESC</td><td class="cell">Descriptor</td><td class="cell">STRING [41]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">ZRST</td><td class="cell">Zero String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ONST</td><td class="cell">One String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TWST</td><td class="cell">Two String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">THST</td><td class="cell">Three String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FRST</td><td class="cell">Four String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FVST</td><td class="cell">Five String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SXST</td><td class="cell">Six String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SVST</td><td class="cell">Seven String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">EIST</td><td class="cell">Eight String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NIST</td><td class="cell">Nine String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TEST</td><td class="cell">Ten String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ELST</td><td class="cell">Eleven String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TVST</td><td class="cell">Twelve String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TTST</td><td class="cell">Thirteen String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FTST</td><td class="cell">Fourteen String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FFST</td><td class="cell">Fifteen String</td><td class="cell">STRING [26]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h3><a class='u'
name="Alarm-Parameters"
>Alarm Parameters</a></h3>

<p>The possible alarm conditions for multi-bit binary inputs are the SCAN,
READ,
and state alarms.
The state alarms are configured in the below severity fields.
These fields have the usual possible values for severity fields: NO_ALARM,
MINOR,
and MAJOR.</p>

<p>The unknown state severity (UNSV) field,
if set to MINOR or MAJOR,
triggers an alarm when the record support routine cannot find a matching value in the state value fields for <code>rval</code>.</p>

<p>The change of state severity (COSV) field triggers an alarm when any change of state occurs,
if set to MAJOR or MINOR.</p>

<p>The other fields,
when set to MAJOR or MINOR,
trigger an alarm when VAL equals the corresponding state.</p>

<p>See <a href="https://docs.epics-controls.org/en/latest/guides/EPICS_Process_Database_Concepts.html#alarm-specification" class="podlinkurl"
>Alarm Specification</a> for a complete explanation of record alarms and of the standard fields.
<a href="dbCommonRecord.html#Alarm-Fields" class="podlinkpod"
>Alarm Fields</a> lists other fields related to alarms that are common to all record types.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">UNSV</td><td class="cell">Unknown State Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">COSV</td><td class="cell">Change of State Svr</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ZRSV</td><td class="cell">State Zero Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ONSV</td><td class="cell">State One Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TWSV</td><td class="cell">State Two Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">THSV</td><td class="cell">State Three Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FRSV</td><td class="cell">State Four Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FVSV</td><td class="cell">State Five Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SXSV</td><td class="cell">State Six Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SVSV</td><td class="cell">State Seven Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">EISV</td><td class="cell">State Eight Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NISV</td><td class="cell">State Nine Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TESV</td><td class="cell">State Ten Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">ELSV</td><td class="cell">State Eleven Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TVSV</td><td class="cell">State Twelve Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">TTSV</td><td class="cell">State Thirteen Sevr</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FTSV</td><td class="cell">State Fourteen Sevr</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">FFSV</td><td class="cell">State Fifteen Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h3><a class='u'
name="Run-time-Parameters"
>Run-time Parameters</a></h3>

<p>These parameters are used by the run-time code for processing the multi-bit binary input.</p>

<p>ORAW is used by record processing to hold the prior RVAL for use in determining when to post a monitor event for the RVAL field.</p>

<p>The LALM field implements the change of state alarm severity by holding the value of VAL when the previous change of state alarm was issued.</p>

<p>MLST holds the value when the last monitor for value change was triggered.</p>

<p>SDEF is used by record support to save time if no states are defined.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">ORAW</td><td class="cell">Prev Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">LALM</td><td class="cell">Last Value Alarmed</td><td class="cell">USHORT</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">MLST</td><td class="cell">Last Value Monitored</td><td class="cell">USHORT</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">SDEF</td><td class="cell">States Defined</td><td class="cell">SHORT</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Simulation-Mode-Parameters"
>Simulation Mode Parameters</a></h3>

<p>The following fields are used to operate the record in simulation mode.</p>

<p>If SIMM (fetched through SIML) is YES or RAW,
the record is put in SIMS severity and the value is fetched through SIOL (buffered in SVAL).
If SIMM is YES,
SVAL is written to VAL without conversion,
if SIMM is RAW,
SVAL is trancated to RVAL and converted.
SSCN sets a different SCAN mechanism to use in simulation mode.
SDLY sets a delay (in sec) that is used for asynchronous simulation processing.</p>

<p>See <a href="dbCommonInput.html#Input-Simulation-Fields" class="podlinkpod"
>Input Simulation Fields</a> for more information on simulation mode and its fields.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">SIML</td><td class="cell">Simulation Mode Link</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIMM</td><td class="cell">Simulation Mode</td><td class="cell">MENU (<a href='menuSimm.html'>menuSimm</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIOL</td><td class="cell">Simulation Input Link</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SVAL</td><td class="cell">Simulation Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIMS</td><td class="cell">Simulation Mode Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SDLY</td><td class="cell">Sim. Mode Async Delay</td><td class="cell">DOUBLE</td><td class="cell">Yes</td><td class="cell">-1.0</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SSCN</td><td class="cell">Sim. Mode Scan</td><td class="cell">MENU (<a href='menuScan.html'>menuScan</a>)</td><td class="cell">Yes</td><td class="cell">65535</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h2><a class='u'
name="Record-Support"
>Record Support</a></h2>

<h3><a class='u'
name="Record-Support-Routines"
>Record Support Routines</a></h3>

<h4><a class='u'
name="init_record"
>init_record</a></h4>

<p>This routine initializes SIMM with the value of SIML if SIML type is CONSTANT link or creates a channel access link if SIML type is PV_LINK.
SVAL is likewise initialized if SIOL is CONSTANT or PV_LINK.</p>

<p>This routine next checks to see that device support is available and a device support read routine is defined.
If either does not exist,
an error message is issued and processing is terminated.</p>

<p>Clears MASK and then sets the NOBT low order bits.</p>

<p>If device support includes <code>init_record()</code>,
it is called.</p>

<p>init_common is then called to determine if any states are defined.
If states are defined,
SDEF is set to TRUE.</p>

<h4><a class='u'
name="process"
>process</a></h4>

<p>See next section.</p>

<h4><a class='u'
name="special"
>special</a></h4>

<p>Calls init_common to compute SDEF when any of the fields ZRVL,
...
FFVL change value.</p>

<h4><a class='u'
name="get_enum_str"
>get_enum_str</a></h4>

<p>Retrieves ASCII string corresponding to VAL.</p>

<h4><a class='u'
name="get_enum_strs"
>get_enum_strs</a></h4>

<p>Retrieves ASCII strings for ZRST,...FFST.</p>

<h4><a class='u'
name="put_enum_str"
>put_enum_str</a></h4>

<p>Checks if string matches ZRST,...FFST and if it does,
sets VAL.</p>

<h3><a class='u'
name="Record-Processing"
>Record Processing</a></h3>

<p>Routine process implements the following algorithm:</p>

<ol>
<li>Check to see that the appropriate device support module exists.
If it doesn&#39;t,
an error message is issued and processing is terminated with the PACT field still set to TRUE.
This ensures that processes will no longer be called for this record.
Thus error storms will not occur.</li>

<li>readValue is called.
See <a href="#Input-Records" class="podlinkpod"
>&#34;Input Records&#34;</a> for more information.</li>

<li>If PACT has been changed to TRUE,
the device support read routine has started but has not completed reading a new input value.
In this case,
the processing routine merely returns,
leaving PACT TRUE.</li>

<li>Convert:
<ul>
<li>status=read_mbbi</li>

<li>PACT = TRUE</li>

<li><code>recGblGetTimeStamp()</code> is called.</li>

<li>If status is 0,
then determine VAL
<ul>
<li>Set rval = RVAL</li>

<li>Shift rval right SHFT bits</li>
</ul>
</li>

<li>If at least one state value is defined
<ul>
<li>Set UDF to TRUE</li>
</ul>
</li>

<li>If RVAL is ZRVL,...,FFVL then set
<ul>
<li>VAL equals index of state</li>

<li>UDF set to FALSE</li>
</ul>
</li>

<li>Else set VAL = undefined
<ul>
<li>Else set VAL = RVAL</li>
</ul>
</li>

<li>Set UDF to FALSE
<ul>
<li>If status is 1,
return 0</li>

<li>If status is 2,
set status = 0</li>
</ul>
</li>
</ul>
</li>

<li>Check alarms.
This routine checks to see if the new VAL causes the alarm status and severity to change.
If so,
NSEV,
NSTA and LALM are set.</li>

<li>Check to see if monitors should be invoked.
<ul>
<li>Alarm monitors are invoked if the alarm status or severity has changed.</li>

<li>Archive and value change monitors are invoked if MLST is not equal to VAL.</li>

<li>Monitors for RVAL are checked whenever other monitors are invoked.</li>

<li>NSEV and NSTA are reset to 0.</li>
</ul>
</li>

<li>Scan forward link if necessary,
set PACT FALSE,
and return.</li>
</ol>

<h2><a class='u'
name="Device-Support"
>Device Support</a></h2>

<h3><a class='u'
name="Fields-Of-Interest-To-Device-Support"
>Fields Of Interest To Device Support</a></h3>

<p>Each input record must have an associated set of device support routines.</p>

<p>The primary responsibility of the device support routines is to obtain a new raw input value whenever read_mbbi is called.
The device support routines are primarily interested in the following fields:</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">PACT</td><td class="cell">Record active</td><td class="cell">UCHAR</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">DPVT</td><td class="cell">Device Private</td><td class="cell">NOACCESS</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">No</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">UDF</td><td class="cell">Undefined</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">1</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NSEV</td><td class="cell">New Alarm Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NSTA</td><td class="cell">New Alarm Status</td><td class="cell">MENU (<a href='menuAlarmStat.html'>menuAlarmStat</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NOBT</td><td class="cell">Number of Bits</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">VAL</td><td class="cell">Current Value</td><td class="cell">ENUM</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">INP</td><td class="cell">Input Specification</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">RVAL</td><td class="cell">Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">MASK</td><td class="cell">Hardware Mask</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">SHFT</td><td class="cell">Shift</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Device-Support-Routines"
>Device Support Routines</a></h3>

<p>Device support consists of the following routines:</p>

<h4><a class='u'
name="long-report-int-level"
>long report(int level)</a></h4>

<p>This optional routine is called by the IOC command <code>dbior</code> and is passed the report level that was requested by the user.
It should print a report on the state of the device support to stdout.
The <code>level</code> parameter may be used to output increasingly more detailed information at higher levels,
or to select different types of information with different levels.
Level zero should print no more than a small summary.</p>

<h4><a class='u'
name="long-init-int-after"
>long init(int after)</a></h4>

<p>This optional routine is called twice at IOC initialization time.
The first call happens before any of the <code>init_record()</code> calls are made,
with the integer parameter <code>after</code> set to 0.
The second call happens after all of the <code>init_record()</code> calls have been made,
with <code>after</code> set to 1.</p>

<h4><a class='u'
name="init_record"
>init_record</a></h4>

<pre>  init_record(precord)</pre>

<p>This routine is optional. If provided, it is called by the record support <code>init_record()</code> routine. If it uses MASK, it should shift it as necessary and also give SHFT a value.</p>

<h4><a class='u'
name="get_ioint_info"
>get_ioint_info</a></h4>

<pre>  get_ioint_info(int cmd,struct dbCommon *precord,IOSCANPVT *ppvt)</pre>

<p>This routine is called by the ioEventScan system each time the record is added or deleted from an I/O event scan list. <code>cmd</code> has the value (0,1) if the record is being (added to, deleted from) an I/O event list. It must be provided for any device type that can use the I/O Event scanner.</p>

<h4><a class='u'
name="read_mbbi"
>read_mbbi</a></h4>

<pre>  read_mbbi(precord)</pre>

<p>This routine must provide a new input value. It returns the following values:</p>

<ul>
<li>0: Success. A new raw value is placed in RVAL. The record support module determines VAL from RVAL, SHFT, and ZEVL ... FFVL.</li>

<li>2: Success, but don&#39;t modify VAL.</li>

<li>Other: Error.</li>
</ul>

<h3><a class='u'
name="Device-Support-For-Soft-Records"
>Device Support For Soft Records</a></h3>

<p>Two soft device support modules <code>Soft Channel</code> and <code>Raw Soft Channel</code> are provided for multi-bit binary input records not related to actual hardware devices. The INP link type must be either CONSTANT, DB_LINK, or CA_LINK.</p>

<h4><a class='u'
name="Soft-Channel"
>Soft Channel</a></h4>

<p>read_mbbi always returns a value of 2, which means that no conversion is performed.</p>

<p>If the INP link type is constant, then the constant value is stored into VAL by <code>init_record()</code>, and UDF is set to FALSE. VAL can be changed via dbPut requests. If the INP link type is PV_LINK, then dbCaAddInlink is called by <code>init_record()</code>.</p>

<p>read_mbbi calls recGblGetLinkValue to read the current value of VAL. See <a href="#Soft-Input" class="podlinkpod"
>&#34;Soft Input&#34;</a>.</p>

<p>If the return status of recGblGetLinkValue is zero, then read_mbbi sets UDF to FALSE. The status of recGblGetLinkValue is returned.</p>

<h4><a class='u'
name="Raw-Soft-Channel"
>Raw Soft Channel</a></h4>

<p>This module is like the previous except that values are read into RVAL, VAL is computed from RVAL, and read_mbbi returns a value of 0. Thus the record processing routine will determine VAL in the normal way.</p>
</div>


<!-- end doc -->

</body></html>
