<html><head><title>Multi-Bit Binary Output Direct Record (mbboDirect)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
<link rel="stylesheet" type="text/css" title="pod_stylesheet" href="style.css">

</head>
<body class='pod'>
<!--
  generated by EPICS::PodHtml v,
  using Pod::Simple::PullParser v3.35,
  under Perl v5.026003 at Thu May 15 03:29:27 2025 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to EPICS::PodHtml, and/or subclassing EPICS::PodHtml,
   then reconverting this document from the Pod source.
   When in doubt, email the author of EPICS::PodHtml for advice.
   See 'perldoc EPICS::PodHtml' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>
<div class="pod">


<h1><a class='u'
name="Multi-Bit-Binary-Output-Direct-Record-mbboDirect"
>Multi-Bit Binary Output Direct Record (mbboDirect)</a></h1>

<p>The mbboDirect record performs roughly the opposite function to that of the <a href="mbbiDirectRecord.html" class="podlinkpod"
>mbbiDirect record</a>.</p>

<p>It can accept boolean values in its 32 bit fields (B0-B9,
BA-BF,
B10-B19 and B1A-B1F),
and converts them to a 32-bit signed integer in VAL which is provided to the device support.
A zero value in a bit field becomes a zero bit in VAL,
a non-zero value in a bit field becomes a one bit in VAL,
with B0 being the least signficant bit and B1F the MSB/sign bit.</p>

<h2><a class='u'
name="Parameter-Fields"
>Parameter Fields</a></h2>

<p>The record-specific fields are described below,
grouped by functionality.</p>

<h3><a class='u'
name="Scan-Parameters"
>Scan Parameters</a></h3>

<p>The mbboDirect record has the standard fields for specifying under what circumstances it will be processed.
These fields are listed in <a href="dbCommonRecord.html#Scan-Fields" class="podlinkpod"
>Scan Fields</a>.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">SCAN</td><td class="cell">Scan Mechanism</td><td class="cell">MENU (<a href='menuScan.html'>menuScan</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">PHAS</td><td class="cell">Scan Phase</td><td class="cell">SHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">EVNT</td><td class="cell">Event Name</td><td class="cell">STRING [40]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">PRIO</td><td class="cell">Scheduling Priority</td><td class="cell">MENU (<a href='menuPriority.html'>menuPriority</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">PINI</td><td class="cell">Process at iocInit</td><td class="cell">MENU (<a href='menuPini.html'>menuPini</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Desired-Output-Parameters"
>Desired Output Parameters</a></h3>

<p>Like all output records,
the mbboDirect record must specify where its output should originate when it gets processed.
The Output Mode SeLect field (OMSL) determines whether the output value should be read from another record or not.
When set to <code>closed_loop</code>,
a 32-bit integer value (the &#34;desired output&#34;) will be read from a link specified in the Desired Output Link (DOL) field and placed into the VAL field.</p>

<p>When OMSL is set to <code>supervisory</code>,
the DOL field is ignored during processing and the contents of VAL are used.
A value to be output may thus be written direcly into the VAL field from elsewhere as long as the record is in <code>supervisory</code> mode.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">OMSL</td><td class="cell">Output Mode Select</td><td class="cell">MENU (<a href='menuOmsl.html'>menuOmsl</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">DOL</td><td class="cell">Desired Output Link</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">VAL</td><td class="cell">Word</td><td class="cell">LONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h4><a class='u'
name="Bit-Fields"
>Bit Fields</a></h4>

<p>The fields B0 through BF and B10 through B1F provide an alternative way to set the individual bits of the VAL field when the record is in <code>supervisory</code> mode.
Writing to one of these fields will then modify the corresponding bit in VAL,
and writing to VAL will update these bit fields from that value.</p>

<p>The VAL field is signed so it can be accessed through Channel Access as an integer; if it were made unsigned (a <code>DBF_ULONG</code>) its representation through Channel Access would become a <code>double</code>,
which could cause problems with some client programs.</p>

<p>Prior to the EPICS 7.0.6.1 release the individual bit fields were not updated while the record was in <code>closed_loop</code> mode with VAL being set from the DOL link,
and writing to the bit fields in that mode could cause the record to process but the actual field values would not affect VAL at all.
Changing the OMSL field from <code>closed_loop</code> to <code>supervisory</code> would set the bit fields from VAL at that time and trigger a monitor event for the bits that changed at that time.
At record initialization if VAL is defined and the OMSL field is <code>supervisory</code> the bit fields would be set from VAL.</p>

<p>From EPICS 7.0.6.1 the bit fields get updated from VAL during record processing and monitors are triggered on them in either mode.
Attempts to write to the bit fields while in <code>closed_loop</code> mode will be rejected by the <code>special()</code> routine which may trigger an error from the client that wrote to them.
During initialization if the record is still undefined (UDF) after DOL has been read and the device support initialized but at least one of the B0-B1F fields is non-zero,
the VAL field will be set from those fields and UDF will be cleared.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">B0</td><td class="cell">Bit 0</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B1</td><td class="cell">Bit 1</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B2</td><td class="cell">Bit 2</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B3</td><td class="cell">Bit 3</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B4</td><td class="cell">Bit 4</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B5</td><td class="cell">Bit 5</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B6</td><td class="cell">Bit 6</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B7</td><td class="cell">Bit 7</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B8</td><td class="cell">Bit 8</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B9</td><td class="cell">Bit 9</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">BA</td><td class="cell">Bit 10</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">BB</td><td class="cell">Bit 11</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">BC</td><td class="cell">Bit 12</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">BD</td><td class="cell">Bit 13</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">BE</td><td class="cell">Bit 14</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">BF</td><td class="cell">Bit 15</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B10</td><td class="cell">Bit 16</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B11</td><td class="cell">Bit 17</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B12</td><td class="cell">Bit 18</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B13</td><td class="cell">Bit 19</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B14</td><td class="cell">Bit 20</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B15</td><td class="cell">Bit 21</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B16</td><td class="cell">Bit 22</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B17</td><td class="cell">Bit 23</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B18</td><td class="cell">Bit 24</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B19</td><td class="cell">Bit 25</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B1A</td><td class="cell">Bit 26</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B1B</td><td class="cell">Bit 27</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B1C</td><td class="cell">Bit 28</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B1D</td><td class="cell">Bit 29</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B1E</td><td class="cell">Bit 30</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">B1F</td><td class="cell">Bit 31</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

</table></blockquote>


<h3><a class='u'
name="Convert-and-Write-Parameters"
>Convert and Write Parameters</a></h3>

<p>For records that are to write values to hardware devices,
the OUT output link must contain the address of the I/O card,
and the DTYP field must specify the proper device support module.
Be aware that the address format differs according to the I/O bus used.
See <a href="https://docs.epics-controls.org/en/latest/guides/EPICS_Process_Database_Concepts.html#address-specification" class="podlinkurl"
>Address Specification</a> for information on the format of hardware addresses.</p>

<p>During record processing VAL is converted into RVAL,
which is the actual 32-bit word to be sent out.
RVAL is set to VAL shifted left by the number of bits specified in the SHFT field (SHFT is normally set by device support).
RVAL is then sent out to the location specified in the OUT field.</p>

<p>The fields NOBT and MASK can be used by device support to force some of the output bits written by that support to be zero.
By default all 32 bits can be sent,
but the NOBT field can be set to specify a smaller number of contiguous bits,
or MASK can specify a non-contiguous set of bits.
When setting MASK it is often necessary to set NOBT to a non-zero value as well,
although in this case the actual value of NOBT may be ignored by the device support.
If a device support sets the SHFT field it will also left-shift the value of MASK at the same time.</p>

<p>For mbboDirect records writing to a link instead of to hardware,
the DTYP field must select one of the soft device support routines <code>Soft Channel</code> or <code>Raw Soft Channel</code>.
The <code>Soft Channel</code> support writes the contents of the VAL field to the output link.
The <code>Raw Soft Channel</code> support allows SHFT to be set in the DB file,
and sends the result of ANDing the shifted MASK with the RVAL field&#39;s value.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">OUT</td><td class="cell">Output Specification</td><td class="cell">OUTLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">RVAL</td><td class="cell">Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">Yes</td></tr>

<tr><td class="cell">SHFT</td><td class="cell">Shift</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">MASK</td><td class="cell">Hardware Mask</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NOBT</td><td class="cell">Number of Bits</td><td class="cell">SHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Operator-Display-Parameters"
>Operator Display Parameters</a></h3>

<p>See <a href="dbCommonRecord.html#Operator-Display-Parameters" class="podlinkpod"
>Fields Common to All Record Types</a> for more on the record name (NAME) and description (DESC) fields.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">NAME</td><td class="cell">Record Name</td><td class="cell">STRING [61]</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">DESC</td><td class="cell">Descriptor</td><td class="cell">STRING [41]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Run-time-Parameters"
>Run-time Parameters</a></h3>

<p>These parameters are used by the run-time code for processing the mbbo Direct record.</p>

<p>MASK is used by device support routine to read the hardware register.
Record support sets the low order NOBT bits of MASK at initialization,
and device support is allowed to shift this value.</p>

<p>MLST holds the value when the last monitor for value change was triggered.
OBIT has a similar role for bits held in the B0-B1F fields.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">NOBT</td><td class="cell">Number of Bits</td><td class="cell">SHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">ORAW</td><td class="cell">Prev Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">MASK</td><td class="cell">Hardware Mask</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">MLST</td><td class="cell">Last Value Monitored</td><td class="cell">LONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">OBIT</td><td class="cell">Last Bit mask Monitored</td><td class="cell">LONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Simulation-Mode-Parameters"
>Simulation Mode Parameters</a></h3>

<p>The following fields are used to operate the record in simulation mode.</p>

<p>If SIMM (fetched through SIML) is YES,
the record is put in SIMS severity and the value is written through SIOL,
without conversion.
If SIMM is RAW,
the value is converted and RVAL is written.
SSCN sets a different SCAN mechanism to use in simulation mode.
SDLY sets a delay (in sec) that is used for asynchronous simulation processing.</p>

<p>See <a href="dbCommonOutput.html#Output-Simulation-Fields" class="podlinkpod"
>Output Simulation Fields</a> for more information on simulation mode and its fields.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">SIML</td><td class="cell">Simulation Mode Link</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIMM</td><td class="cell">Simulation Mode</td><td class="cell">MENU (<a href='menuSimm.html'>menuSimm</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIOL</td><td class="cell">Simulation Output Link</td><td class="cell">OUTLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIMS</td><td class="cell">Simulation Mode Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SDLY</td><td class="cell">Sim. Mode Async Delay</td><td class="cell">DOUBLE</td><td class="cell">Yes</td><td class="cell">-1.0</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SSCN</td><td class="cell">Sim. Mode Scan</td><td class="cell">MENU (<a href='menuScan.html'>menuScan</a>)</td><td class="cell">Yes</td><td class="cell">65535</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Alarm-Parameters"
>Alarm Parameters</a></h3>

<p>The possible alarm conditions for mbboDirect records are the SCAN,
READ,
and INVALID alarms.</p>

<p>The IVOA field specifies an action to take when an INVALID alarm is triggered.
There are three possible actions: <code>Continue normally</code>,
<code>Don&#39;t drive outputs</code>,
or <code>Set output to IVOV</code>.
When <code>Set output to IVOV</code> is specified and a INVALID alarm is triggered,
the record will write the value in the IVOV field to the output.</p>

<p>See <a href="dbCommonOutput.html#Invalid-Output-Action-Fields" class="podlinkpod"
>Invalid Output Action Fields</a> for more information about IVOA and IVOV.</p>

<p>See <a href="https://docs.epics-controls.org/en/latest/guides/EPICS_Process_Database_Concepts.html#alarm-specification" class="podlinkurl"
>Alarm Specification</a> for a complete explanation of record alarms and of the standard fields.
<a href="dbCommonRecord.html#Alarm-Fields" class="podlinkpod"
>Alarm Fields</a> lists other fields related to alarms that are common to all record types.</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">IVOA</td><td class="cell">INVALID outpt action</td><td class="cell">MENU (<a href='menuIvoa.html'>menuIvoa</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">IVOV</td><td class="cell">INVALID output value</td><td class="cell">LONG</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h2><a class='u'
name="Record-Support"
>Record Support</a></h2>

<h3><a class='u'
name="Record-Support-Routines"
>Record Support Routines</a></h3>

<h4><a class='u'
name="init_record"
>init_record</a></h4>

<p>This routine initializes SIMM if SIML is a constant or creates a channel access link if SIML is PV_LINK.
If SIOL is PV_LINK a channel access link is created.</p>

<p>This routine next checks to see that device support is available.The routine next checks to see if the device support write routine is defined.
If either device support or the device support write routine does not exist,
an error message is issued and processing is terminated.</p>

<p>If DOL is a constant,
then VAL is initialized to its value and UDF is set to FALSE.</p>

<p>MASK is cleared and then the NOBT low order bits are set.</p>

<p>If device support includes <code>init_record()</code>,
it is called.</p>

<p>If device support returns success,
VAL is then set from RVAL and UDF is set to FALSE.</p>

<h4><a class='u'
name="Process"
>Process</a></h4>

<p>See next section.</p>

<h3><a class='u'
name="Record-Processing"
>Record Processing</a></h3>

<p>Routine process implements the following algorithm:</p>

<ol>
<li>Check to see that the appropriate device support module exists.
If it doesn&#39;t,
an error message is issued and processing is terminated with the PACT field still set to TRUE.
This ensures that processes will no longer be called for this record.
Thus error storms will not occur.</li>

<li>If PACT is FALSE
<ul>
<li>If DOL is DB_LINK and OMSL is CLOSED_LOOP
<ul>
<li>Get value from DOL</li>

<li>Set PACT to FALSE</li>
</ul>
</li>
</ul>
</li>

<li>Convert
<ul>
<li>If PACT is FALSE,
compute RVAL
<ul>
<li>Set RVAL = VAL</li>

<li>Shift RVAL left SHFT bits</li>
</ul>
</li>

<li>Status=write_mbboDirect</li>
</ul>
</li>

<li>If PACT has been changed to TRUE,
the device support write output routine has started but has not completed writing the new value.
In this case,
the processing routine merely returns,
leaving PACT TRUE.</li>

<li>Check to see if monitors should be invoked.
<ul>
<li>Alarm monitors are invoked if the alarm status or severity has changed.</li>

<li>Archive and value change monitors are invoked if MLST is not equal to VAL.</li>

<li>Monitors for RVAL and RBV are checked whenever other monitors are invoked.</li>

<li>NSEV and NSTA are reset to 0.</li>
</ul>
</li>

<li>Scan forward link if necessary,
set PACT FALSE,
and return.</li>
</ol>
<br><hr><br>


<h2><a class='u'
name="Device-Support"
>Device Support</a></h2>

<h3><a class='u'
name="Fields-Of-Interest-To-Device-Support"
>Fields Of Interest To Device Support</a></h3>

<p>Each mbboDirect record must have an associated set of device support routines.
The primary responsibility of the device support routines is to obtain a new raw mbbo value whenever write_mbboDirect is called.
The device support routines are primarily interested in the following fields:</p>
<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">PACT</td><td class="cell">Record active</td><td class="cell">UCHAR</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">DPVT</td><td class="cell">Device Private</td><td class="cell">NOACCESS</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">No</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">UDF</td><td class="cell">Undefined</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">1</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NSEV</td><td class="cell">New Alarm Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NSTA</td><td class="cell">New Alarm Status</td><td class="cell">MENU (<a href='menuAlarmStat.html'>menuAlarmStat</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NOBT</td><td class="cell">Number of Bits</td><td class="cell">SHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">OUT</td><td class="cell">Output Specification</td><td class="cell">OUTLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">RVAL</td><td class="cell">Raw Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">Yes</td></tr>

<tr><td class="cell">RBV</td><td class="cell">Readback Value</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">MASK</td><td class="cell">Hardware Mask</td><td class="cell">ULONG</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">SHFT</td><td class="cell">Shift</td><td class="cell">USHORT</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>


<h3><a class='u'
name="Device-Support-Routines"
>Device Support Routines</a></h3>

<p>Device support consists of the following routines:</p>

<h4><a class='u'
name="long-report-int-level"
>long report(int level)</a></h4>

<p>This optional routine is called by the IOC command <code>dbior</code> and is passed the report level that was requested by the user.
It should print a report on the state of the device support to stdout.
The <code>level</code> parameter may be used to output increasingly more detailed information at higher levels,
or to select different types of information with different levels.
Level zero should print no more than a small summary.</p>

<h4><a class='u'
name="long-init-int-after"
>long init(int after)</a></h4>

<p>This optional routine is called twice at IOC initialization time.
The first call happens before any of the <code>init_record()</code> calls are made,
with the integer parameter <code>after</code> set to 0.
The second call happens after all of the <code>init_record()</code> calls have been made,
with <code>after</code> set to 1.</p>

<h4><a class='u'
name="init_record"
>init_record</a></h4>

<pre>  init_record(precord)</pre>

<p>This routine is optional. If provided, it is called by the record support <code>init_record()</code> routine. If MASK is used, it should be shifted if necessary and SHFT given a value.</p>

<h4><a class='u'
name="get_ioint_info"
>get_ioint_info</a></h4>

<pre>  get_ioint_info(int cmd,struct dbCommon *precord,IOSCANPVT *ppvt)</pre>

<p>This routine is called by the ioEventScan system each time the record is added or deleted from an I/O event scan list. <code>cmd</code> has the value (0,1) if the record is being (added to, deleted from) an I/O event list. It must be provided for any device type that can use the ioEvent scanner.</p>

<h4><a class='u'
name="write_mbboDirect"
>write_mbboDirect</a></h4>

<pre>  write_mbboDirect(precord)</pre>

<p>This routine must output a new value. It returns the following values:</p>

<ul>
<li>0: Success.</li>

<li>Other: Error.</li>
</ul>

<h3><a class='u'
name="Device-Support-For-Soft-Records"
>Device Support For Soft Records</a></h3>

<p>This <code>SOft Channel</code> module writes the current value of VAL.</p>

<p>If the OUT link type is PV_LINK, then dbCaAddInlink is called by <code>init_record()</code>.</p>

<p>write_mbboDirect calls recGblPutLinkValue to write the current value of VAL.</p>

<p>See <a href="Soft_Output.html" class="podlinkpod"
>Soft Output</a>.</p>
</div>


<!-- end doc -->

</body></html>
